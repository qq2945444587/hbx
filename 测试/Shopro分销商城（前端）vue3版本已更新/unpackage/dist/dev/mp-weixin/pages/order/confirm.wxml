<view class="order-wrap data-v-400081d6"><block wx:if="{{orderPre.need_address}}"><view data-event-opts="{{[['tap',[['jump',['/pages/user/address/list',['o',['from','order']]]]]]]}}" class="head_box data-v-400081d6" bindtap="__e"><block wx:if="{{!addressId}}"><view class="add-address-box u-flex u-flex-1 data-v-400081d6"><view class="box-bg u-p-30 u-flex-1 u-flex u-row-between data-v-400081d6"><text class="select-notice data-v-400081d6">请选择收货地址</text><text class="u-iconfont uicon-arrow-right data-v-400081d6" style="color:#bfbfbf;"></text></view></view></block><block wx:else><view class="add-address-box u-p-30 data-v-400081d6"><view class="top u-flex data-v-400081d6"><text class="name data-v-400081d6">{{addressData.consignee}}</text><text class="phone data-v-400081d6">{{addressData.phone}}</text><text hidden="{{!(addressData.is_default==1)}}" class="tag data-v-400081d6">默认</text></view><view class="detail u-flex u-row-between data-v-400081d6"><view class="address data-v-400081d6">{{''+addressData.province_name+addressData.city_name+addressData.area_name+addressData.address+''}}</view><text class="u-iconfont uicon-arrow-right data-v-400081d6" style="color:#bfbfbf;"></text></view></view></block></view></block><view class="u-m-b-10 data-v-400081d6"><block wx:for="{{$root.l0}}" wx:for-item="g" wx:for-index="__i0__" wx:key="sku_price_id"><view class="goods-list data-v-400081d6"><view class="goods-card u-p-30 data-v-400081d6"><shopro-mini-card vue-id="{{'7fdf8c20-1-'+__i0__}}" title="{{g.$orig.detail.title}}" image="{{g.$orig.detail.image}}" class="data-v-400081d6" bind:__l="__l" vue-slots="{{['describe','cardBottom']}}"><view class="order-sku u-ellipsis-1 data-v-400081d6" slot="describe"><text class="order-num data-v-400081d6">{{''+(g.$orig.detail.current_sku_price&&g.$orig.detail.current_sku_price.goods_sku_text?g.$orig.detail.current_sku_price.goods_sku_text:'')+''}}</text></view><view class="goods-price u-flex  u-row-between data-v-400081d6" slot="cardBottom"><view class="data-v-400081d6"><text hidden="{{!(orderType==='score')}}" class="data-v-400081d6">{{g.$orig.detail.current_sku_price.score+"积分+"}}</text><text class="data-v-400081d6">{{"￥"+g.$orig.detail.current_sku_price.price}}</text></view><text class="goods-num data-v-400081d6">{{"x"+g.$orig.goods_num}}</text></view></shopro-mini-card></view><view data-event-opts="{{[['tap',[['onSelExpressType',['$0'],[[['perGoodsList','sku_price_id',g.$orig.sku_price_id]]]]]]]}}" class="logistic item-list u-flex u-row-between data-v-400081d6" bindtap="__e"><view class="item-title data-v-400081d6">配送方式</view><view class="u-flex data-v-400081d6"><view class="detail data-v-400081d6">{{g.m0}}</view><text class="u-iconfont uicon-arrow-right data-v-400081d6" style="color:#bfbfbf;"></text></view></view></view></block><block wx:if="{{$root.g0}}"><block class="data-v-400081d6"><view class="remark-box u-flex item-list u-p-30 data-v-400081d6"><view class="item-title data-v-400081d6">备注</view><input class="item-input  data-v-400081d6" placeholder-class="input-pl" type="text" placeholder="建议留言前先于卖家沟通确认" data-event-opts="{{[['input',[['__set_model',['','remark','$event',[]]]]]]}}" value="{{remark}}" bindinput="__e"/></view><block wx:if="{{hasCoupons}}"><sh-select-coupon vue-id="7fdf8c20-2" couponList="{{couponList}}" data-event-opts="{{[['^change',[['selectCoupon']]]]}}" bind:change="__e" class="data-v-400081d6" bind:__l="__l"></sh-select-coupon></block><view hidden="{{!(orderType==='score')}}" class="score item-list u-flex u-row-between data-v-400081d6"><view class="u-flex data-v-400081d6"><text class="item-title data-v-400081d6">积分</text></view><view class="price data-v-400081d6">{{"-"+(orderPre.score_amount||0)+"积分"}}</view></view><view class=" u-flex u-row-between item-list border-top u-m-b-10 data-v-400081d6"><view class="item-title data-v-400081d6">商品金额</view><view class="u-flex data-v-400081d6"><text class="price data-v-400081d6">{{"￥"+(orderPre.goods_amount||'0.00')}}</text></view></view><block wx:if="{{$root.g1}}"><u-collapse vue-id="7fdf8c20-3" event-type="close" arrow="{{true}}" accordion="{{true}}" arrowColor="#bfbfbf" head-style="{{({background:'#fff',height:'100rpx'})}}" class="data-v-400081d6" bind:__l="__l" vue-slots="{{['default']}}"><u-collapse-item vue-id="{{('7fdf8c20-4')+','+('7fdf8c20-3')}}" class="data-v-400081d6" bind:__l="__l" vue-slots="{{['default','title']}}"><view slot="title" class="data-v-400081d6"><view class="u-flex u-row-between item-list data-v-400081d6" style="width:680rpx;padding-right:0;"><view class="item-title data-v-400081d6">活动优惠</view><view class="u-flex data-v-400081d6"><text class="price data-v-400081d6" style="margin-right:0;">{{"-￥"+(orderPre.activity_discount_money||'0.00')}}</text></view></view></view><block wx:for="{{orderPre.activity_discount_infos}}" wx:for-item="item" wx:for-index="__i1__" wx:key="activity_id"><view class="data-v-400081d6"><block wx:if="{{item.activity_type!=='free_shipping'}}"><view class="u-flex u-row-between item-list data-v-400081d6"><view class="item-title data-v-400081d6">{{item.activity_title}}</view><view class="u-flex data-v-400081d6"><text class="price data-v-400081d6" style="color:#666;">{{"-￥"+(item.activity_discount_money||'0.00')}}</text></view></view></block></view></block></u-collapse-item></u-collapse></block><view class="price-box  u-flex u-row-between item-list data-v-400081d6"><view class="item-title u-flex u-col-center data-v-400081d6"><view class="u-m-r-10 data-v-400081d6">运费</view><block wx:if="{{$root.m1>0}}"><view class="activity-title data-v-400081d6">{{"活动减￥\n\t\t\t\t\t\t"+orderPre.dispatch_discount_money}}</view></block></view><view class="u-flex data-v-400081d6"><block wx:if="{{$root.m2>0}}"><text class="origin-price u-m-r-10 data-v-400081d6">{{"-￥"+orderPre.dispatch_amount}}</text></block><text class="price data-v-400081d6">{{"￥"+$root.m3}}</text></view></view><block wx:if="{{$root.m4}}"><view class="u-flex u-row-between item-list u-p-20 border-top data-v-400081d6"><view class="item-title data-v-400081d6">申请发票</view><view data-event-opts="{{[['tap',[['onInvoice',['$event']]]]]}}" class="u-flex u-col-center data-v-400081d6" bindtap="__e"><text class="selected-invoice data-v-400081d6" style="font-size:28rpx;color:#c4c4c4;">{{selectedInvoice}}</text><text class="u-iconfont uicon-arrow-right data-v-400081d6" style="color:#bfbfbf;"></text></view></view></block></block></block></view><view class="foot-box-wrap data-v-400081d6"><view class="foot-box u-flex u-row-between safe-area-inset-bottom data-v-400081d6"><view class="u-flex data-v-400081d6"><text class="num data-v-400081d6">{{"共"+totalNum+"件"}}</text><view class="all-money data-v-400081d6"><text class="data-v-400081d6">合计：</text><text class="price data-v-400081d6">{{"￥"+(orderPre.total_fee||'0.00')}}</text></view></view><button class="cu-btn sub-btn data-v-400081d6" disabled="{{isDisabled}}" hover-class="btn-hover" data-event-opts="{{[['tap',[['subOrder',['$event']]]]]}}" bindtap="__e">提交订单</button></view></view><u-popup vue-id="7fdf8c20-5" safe-area-inset-bottom="{{true}}" mode="bottom" closeable="{{false}}" border-radius="20" value="{{showInvoice}}" data-event-opts="{{[['^close',[['e0']]],['^input',[['__set_model',['','showInvoice','$event',[]]]]]]}}" bind:close="__e" bind:input="__e" class="data-v-400081d6" bind:__l="__l" vue-slots="{{['default']}}"><view class="invoice-modal page_box data-v-400081d6"><view class="invoice-head u-flex u-col-center data-v-400081d6"><view data-event-opts="{{[['tap',[['changeInvoiceType',['person']]]]]}}" class="head-nav u-flex u-col-center u-row-center data-v-400081d6" bindtap="__e"><text class="{{['nav-title','','data-v-400081d6',(invoiceType==='person')?'nav-title--active':'']}}">个人</text><view hidden="{{!(invoiceType==='person')}}" class="head-nav--active data-v-400081d6"></view></view><view data-event-opts="{{[['tap',[['changeInvoiceType',['company']]]]]}}" class="head-nav u-flex u-col-center u-row-center data-v-400081d6" bindtap="__e"><text class="{{['nav-title','data-v-400081d6',(invoiceType==='company')?'nav-title--active':'']}}">企/事业单位</text><view hidden="{{!(invoiceType==='company')}}" class="head-nav--active data-v-400081d6"></view></view></view><view class="invoice-content content_box data-v-400081d6"><u-form vue-id="{{('7fdf8c20-6')+','+('7fdf8c20-5')}}" labelStyle="{{$root.a0}}" label-position="left" model="{{invoiceForm.model}}" rules="{{invoiceForm.rules}}" errorType="{{['toast']}}" data-ref="invoiceRef" class="data-v-400081d6 vue-ref" bind:__l="__l" vue-slots="{{['default']}}"><u-form-item class="u-p-r-20 data-v-400081d6" vue-id="{{('7fdf8c20-7')+','+('7fdf8c20-6')}}" label-width="150" label="名称:" prop="header_name" bind:__l="__l" vue-slots="{{['default']}}"><u-input bind:input="__e" vue-id="{{('7fdf8c20-8')+','+('7fdf8c20-7')}}" placeholder="请填写名称" type="text" value="{{invoiceForm.model.header_name}}" data-event-opts="{{[['^input',[['__set_model',['$0','header_name','$event',[]],['invoiceForm.model']]]]]}}" class="data-v-400081d6" bind:__l="__l"></u-input></u-form-item><block wx:if="{{invoiceType==='company'}}"><u-form-item class="u-p-r-20 data-v-400081d6" vue-id="{{('7fdf8c20-9')+','+('7fdf8c20-6')}}" label-width="220" label="纳税人识别号:" prop="tax_no" bind:__l="__l" vue-slots="{{['default']}}"><u-input bind:input="__e" vue-id="{{('7fdf8c20-10')+','+('7fdf8c20-9')}}" placeholder="请输入纳税人识别号" type="text" value="{{invoiceForm.model.tax_no}}" data-event-opts="{{[['^input',[['__set_model',['$0','tax_no','$event',[]],['invoiceForm.model']]]]]}}" class="data-v-400081d6" bind:__l="__l"></u-input></u-form-item></block><u-form-item class="u-p-r-20 data-v-400081d6" vue-id="{{('7fdf8c20-11')+','+('7fdf8c20-6')}}" label-width="150" label="手机号:" prop="mobile" bind:__l="__l" vue-slots="{{['default']}}"><u-input bind:input="__e" vue-id="{{('7fdf8c20-12')+','+('7fdf8c20-11')}}" placeholder="请输入填写手机号" type="number" value="{{invoiceForm.model.mobile}}" data-event-opts="{{[['^input',[['__set_model',['$0','mobile','$event',[]],['invoiceForm.model']]]]]}}" class="data-v-400081d6" bind:__l="__l"></u-input></u-form-item></u-form></view><view class="invoice-foot data-v-400081d6"><view class="invoite-price u-flex u-col-center u-row-center u-m-b-40 data-v-400081d6"><text class="price-title data-v-400081d6">可开票金额：</text><text class="price-num data-v-400081d6">{{orderPre.invoice_amount+"元"}}</text></view><view class="u-flex u-col-center u-row-around u-p-b-30 data-v-400081d6"><button data-event-opts="{{[['tap',[['cancelInvoice',['$event']]]]]}}" class="cancel-btn u-reset-button data-v-400081d6" bindtap="__e">取消</button><button data-event-opts="{{[['tap',[['saveInvoice',['$event']]]]]}}" class="save-btn u-reset-button data-v-400081d6" bindtap="__e">确定</button></view></view></view></u-popup><u-popup vue-id="7fdf8c20-13" safe-area-inset-bottom="{{true}}" mode="bottom" closeable="{{false}}" border-radius="20" value="{{showExpressType}}" data-event-opts="{{[['^close',[['e1']]],['^input',[['__set_model',['','showExpressType','$event',[]]]]]]}}" bind:close="__e" bind:input="__e" class="data-v-400081d6" bind:__l="__l" vue-slots="{{['default']}}"><view class="express-type page_box data-v-400081d6"><view class="express-type__head head-box u-flex u-col-center data-v-400081d6"><block wx:for="{{$root.l1}}" wx:for-item="nav" wx:for-index="index" wx:key="id"><block wx:if="{{nav.g2}}"><view data-event-opts="{{[['tap',[['changeExpressType',['$0'],[[['expressType','id',nav.$orig.id,'value']]]]]]]}}" class="express-type__head-nav u-flex u-col-center u-row-center data-v-400081d6" bindtap="__e"><text class="{{['head-nav__title','data-v-400081d6',(expressTypeCur===nav.$orig.value)?'head-nav__title--active':'']}}">{{nav.$orig.title}}</text><view hidden="{{!(expressTypeCur===nav.$orig.value)}}" class="{{['data-v-400081d6',expressClass]}}"></view></view></block></block></view><view class="express-type__content content_box data-v-400081d6"><block wx:if="{{!addressId&&expressTypeCur!=='selfetch'&&expressTypeCur!=='autosend'}}"><view data-event-opts="{{[['tap',[['jump',['/pages/user/address/list',['o',['from','order']]]]]]]}}" class="empty-address u-flex u-col-center data-v-400081d6" bindtap="__e">请选择收货地址<text class="u-iconfont uicon-arrow-right data-v-400081d6" style="color:#999;"></text></view></block><block wx:if="{{expressTypeCur=='express'&&addressId}}"><view class="express-address data-v-400081d6"><view data-event-opts="{{[['tap',[['jump',['/pages/user/address/list',['o',['from','order']]]]]]]}}" class="express-top  u-flex u-row-between data-v-400081d6" bindtap="__e"><view class="u-flex data-v-400081d6"><text hidden="{{!(addressData.is_default==1)}}" class="tag data-v-400081d6" style="white-space:nowrap;">默认</text><text class="address data-v-400081d6">{{addressData.province_name+addressData.city_name+addressData.area_name+addressData.address}}</text><view class="address-guide data-v-400081d6"><text class="u-iconfont uicon-arrow-right data-v-400081d6" style="color:#bfbfbf;"></text></view></view><view class="address-location u-flex-col u-col-center data-v-400081d6"><image class="location-img data-v-400081d6" src="{{$IMG_URL+'/imgs/order/e0.png'}}" mode></image><text class="location-text data-v-400081d6">物流快递</text></view></view><view class="express-content data-v-400081d6"><view class="phone-box1 data-v-400081d6"><text class="name data-v-400081d6">{{addressData.consignee}}</text><text class="phone data-v-400081d6">{{addressData.phone}}</text></view></view></view></block><block wx:if="{{expressTypeCur=='selfetch'}}"><view class="express-address data-v-400081d6"><block wx:if="{{!lat}}"><view class="u-flex-col u-col-center location-box data-v-400081d6"><image class="nolocation-img data-v-400081d6" src="{{$IMG_URL+'/imgs/order/location.png'}}" mode></image><text class="location-title data-v-400081d6">开启定位服务</text><text class="location-tip data-v-400081d6">为你推荐更精准的位置信息噢~</text><button data-event-opts="{{[['tap',[['getLocation',['$event']]]]]}}" class="u-reset-button open-location data-v-400081d6" bindtap="__e">去开启</button></view></block><block wx:else><view class="data-v-400081d6"><view data-event-opts="{{[['tap',[['jump',['/pages/order/express/store-address',['o',['goodsId',currentGoodsId],['lat',lat],['lng',lng],['storeId',storeInfo?storeInfo.id:0]]]]]]]}}" class="express-top u-flex u-col-center u-row-between data-v-400081d6" bindtap="__e"><view class="u-flex data-v-400081d6"><block wx:if="{{addressData.is_default==1}}"><text class="tag1 data-v-400081d6">最近</text></block><text class="address data-v-400081d6">{{storeInfo?storeInfo.name:'暂无自提点'}}</text><text class="u-iconfont uicon-arrow-right data-v-400081d6" style="color:#999;"></text></view><view class="address-location u-flex-col u-col-center data-v-400081d6"><image class="location-img data-v-400081d6" src="{{$IMG_URL+'/imgs/order/e1.png'}}" mode></image><view class="location-text data-v-400081d6">{{"距您"+(storeInfo?storeInfo.distance_text:0)}}</view></view></view><view class="express-content u-flex u-col-cetner data-v-400081d6"><view class="time-box data-v-400081d6"><view class="box-title u-m-b-20 data-v-400081d6">到店时间</view><view data-event-opts="{{[['tap',[['checkExpressTime',['selfetch']]]]]}}" class="box-content u-flex u-col-center data-v-400081d6" bindtap="__e"><text class="box-text data-v-400081d6">{{checkTime['day'][checkDayCur].title+checkTime['time'][checkTimeCur]}}</text><text class="u-iconfont uicon-arrow-right data-v-400081d6" style="color:#999;"></text></view></view><view class="box-line data-v-400081d6"></view><view class="phone-box data-v-400081d6"><view class="box-title u-m-b-20 data-v-400081d6">预留电话</view><view class="box-content u-flex data-v-400081d6" style="width:340rpx;"><u-input bind:input="__e" vue-id="{{('7fdf8c20-14')+','+('7fdf8c20-13')}}" placeholder="请输入预留电话" placeholderStyle="font-size:24rpx" border="{{true}}" height="40" focus="{{getFocus}}" type="number" value="{{selfPhone}}" data-event-opts="{{[['^input',[['__set_model',['','selfPhone','$event',[]]]]]]}}" class="data-v-400081d6" bind:__l="__l"></u-input></view></view></view><view data-event-opts="{{[['tap',[['checkProtocol',['$event']]]]]}}" class="express-bottom data-v-400081d6" bindtap="__e"><u-checkbox vue-id="{{('7fdf8c20-15')+','+('7fdf8c20-13')}}" active-color="#f0c785" value="{{isProtocol}}" class="data-v-400081d6" bind:__l="__l" vue-slots="{{['default']}}"><view class="protocol data-v-400081d6">同意并接受<text data-event-opts="{{[['tap',[['jump',['/pages/public/richtext',['o',['id',initStore.selfetch_protocol]]]]]]]}}" class="protocol-text data-v-400081d6" catchtap="__e">《到店自提服务协议》</text></view></u-checkbox></view></view></block></view></block><block wx:if="{{expressTypeCur=='store'&&addressId}}"><view class="express-address data-v-400081d6"><view data-event-opts="{{[['tap',[['jump',['/pages/user/address/list',['o',['from','order']]]]]]]}}" class="express-top u-flex u-row-between data-v-400081d6" bindtap="__e"><view class="data-v-400081d6"><block wx:if="{{addressData.is_default==1}}"><text class="tag data-v-400081d6">默认</text></block><text class="address data-v-400081d6">{{addressData.province_name+addressData.city_name+addressData.area_name+addressData.address}}</text><text class="address-guide u-iconfont uicon-arrow-right data-v-400081d6" style="color:#999;"></text></view><view class="address-location u-flex-col u-col-center data-v-400081d6"><image class="location-img data-v-400081d6" src="{{$IMG_URL+'/imgs/order/e2.png'}}" mode></image><text class="location-text data-v-400081d6">商家配送</text></view></view><view class="express-content u-flex data-v-400081d6"><view class="time-box data-v-400081d6"><view class="box-title u-m-b-20 data-v-400081d6">配送时间</view><view data-event-opts="{{[['tap',[['checkExpressTime',['store']]]]]}}" class="box-content u-flex data-v-400081d6" bindtap="__e"><text class="box-text data-v-400081d6">{{checkTime['day'][checkDayCur].title+checkTime['time'][checkTimeCur]}}</text><text class="u-iconfont uicon-arrow-right data-v-400081d6" style="color:#999;"></text></view></view><view class="box-line data-v-400081d6"></view><view class="phone-box data-v-400081d6"><view class="box-title u-m-b-20 data-v-400081d6">预留电话</view><view class="box-content u-flex data-v-400081d6"><view class="box-content u-flex data-v-400081d6" style="width:340rpx;"><u-input bind:input="__e" vue-id="{{('7fdf8c20-16')+','+('7fdf8c20-13')}}" placeholder="请输入预留电话" placeholderStyle="font-size:24rpx" border="{{true}}" height="40" focus="{{getFocus}}" type="number" value="{{selfPhone}}" data-event-opts="{{[['^input',[['__set_model',['','selfPhone','$event',[]]]]]]}}" class="data-v-400081d6" bind:__l="__l"></u-input></view></view></view></view></view></block><block wx:if="{{expressTypeCur=='autosend'}}"><view class="express-address data-v-400081d6"><view class="express-top u-flex u-row-between data-v-400081d6"><text class="dispatch-notice data-v-400081d6">订单支付完成后，请在订单详情页查看发货信息</text><view class="address-location u-flex-col u-col-center data-v-400081d6"><image class="location-img data-v-400081d6" src="{{$IMG_URL+'/imgs/order/e3.png'}}" mode></image><text class="location-text data-v-400081d6">自动发货</text></view></view></view></block></view><view hidden="{{!(expressTypeCur!=='selfetch'||expressTypeCur=='selfetch'&&lat)}}" class="express-type__bottom u-flex u-row-between u-p-b-20 data-v-400081d6"><button data-event-opts="{{[['tap',[['hideExpressType',['$event']]]]]}}" class="u-reset-button cancel-btn data-v-400081d6" bindtap="__e">取消</button><button data-event-opts="{{[['tap',[['saveExpressType',['$event']]]]]}}" class="u-reset-button save-btn data-v-400081d6" bindtap="__e">确定</button></view></view></u-popup><u-popup bind:input="__e" vue-id="7fdf8c20-17" mode="bottom" safe-area-inset-bottom="{{true}}" closeable="{{true}}" close-icon-pos="top-right" border-radius="20" value="{{showCheckTime}}" data-event-opts="{{[['^input',[['__set_model',['','showCheckTime','$event',[]]]]]]}}" class="data-v-400081d6" bind:__l="__l" vue-slots="{{['default']}}"><view class="checkTime-box page_box data-v-400081d6"><view class="checkTime-head data-v-400081d6">{{"选择"+checkType+"时间"}}</view><view class="checkTime-content content_box u-flex data-v-400081d6"><view class="checkTime-content__left data-v-400081d6"><block wx:for="{{checkTime.day}}" wx:for-item="day" wx:for-index="index" wx:key="value"><view data-event-opts="{{[['tap',[['check',['day',index]]]]]}}" class="{{['left-item','u-flex','u-row-center','u-col-center','data-v-400081d6',(checkDayCur==index)?'item--active':'']}}" bindtap="__e">{{''+day.title+''}}</view></block></view><scroll-view class="checkTime-content__right scroll-box data-v-400081d6" scroll-into-view="{{'c'+checkTimeId}}" scroll-y="{{true}}" scroll-with-animation="{{true}}"><block wx:for="{{$root.l2}}" wx:for-item="time" wx:for-index="index" wx:key="$orig"><view class="{{['right-item','data-v-400081d6',(checkTimeCur==index)?'item--active':'']}}" id="{{'c'+time.g3[0]}}" data-event-opts="{{[['tap',[['check',['time',index]]]]]}}" bindtap="__e">{{''+time.$orig+''}}</view></block></scroll-view></view><view class=" checkTime-foot u-flex u-row-center u-col-center data-v-400081d6"><button data-event-opts="{{[['tap',[['e2',['$event']]]]]}}" class="u-reset-button save-btn data-v-400081d6" bindtap="__e">保存并使用</button></view></view></u-popup></view>