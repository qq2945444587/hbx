{"version":3,"sources":["uni-app:///main.js","webpack:///E:/测试/ShopXO开源商城uniapp端源码/pages/buy/buy.vue?a3e1","webpack:///E:/测试/ShopXO开源商城uniapp端源码/pages/buy/buy.vue?e7c0","webpack:///E:/测试/ShopXO开源商城uniapp端源码/pages/buy/buy.vue?f377","webpack:///E:/测试/ShopXO开源商城uniapp端源码/pages/buy/buy.vue?312f","uni-app:///pages/buy/buy.vue","webpack:///E:/测试/ShopXO开源商城uniapp端源码/pages/buy/buy.vue?2a6e","webpack:///E:/测试/ShopXO开源商城uniapp端源码/pages/buy/buy.vue?d82d"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","common_static_url","data_list_loding_status","buy_submit_disabled_status","data_list_loding_msg","params","payment_list","goods_list","address","address_id","total_price","user_note_value","user_note_status","is_first","extension_data","payment_id","common_site_type","extraction_address","site_model","buy_header_nav","name","value","currency_symbol","common_order_is_booking","buy_datetime_info","plugins_coupon_data","plugins_coupon_list","plugins_use_coupon_ids","plugins_choice_coupon_value","popup_plugins_coupon_status","popup_plugins_coupon_index","plugins_points_data","plugins_points_status","plugins_realstore_data","plugins_choice_realstore_value","popup_plugins_realstore_status","popup_plugins_realstore_group_id","popup_plugins_realstore_card_index","components","componentPopup","componentNoData","componentTimeSelect","props","onLoad","uni","onShow","app","onPullDownRefresh","methods","init_config","init","title","url","method","dataType","success","is_select","required","status","placeholder","time_start","time_end","range_day","disabled","error_msg","key","fail","request_data_ext_params_merge","bind_user_note_event","bind_user_note_tap_event","bind_user_note_blur_event","buy_submit_event","validation","fields","msg","is_can_zero","buy_submit_response_handle","order_ids","payment_event","payment_list_data","plugins_coupon_open_event","temp_list","plugins_coupon_close_event","plugins_coupon_use_event","temp_ids","plugins_coupon_not_use_event","temp","address_event","buy_header_nav_event","map_event","points_event","warehouse_group_event","buy_datetime_event","plugins_realstore_open_event","plugins_realstore_close_event","plugins_realstore_use_event","group_id","data_id","card_id"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,YAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAgH;AAChH;AACuD;AACL;AACa;;;AAG/D;AACyK;AACzK,gBAAgB,kLAAU;AAC1B,EAAE,yEAAM;AACR,EAAE,8EAAM;AACR,EAAE,uFAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,kFAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AChDA;AAAA;AAAA;AAAA;AAAinB,CAAgB,soBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC+OroB;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAAA;EAAA;IAAA;EAAA;AAAA;AAKA;AAAA,eACA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC,iBACA;QAAAC;QAAAC;MAAA,GACA;QAAAD;QAAAC;MAAA,EACA;MACA;MACAC;MACAC;MACA;MACAC;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MACA;MACAC;MACAC;MACA;MACAC;MACAC;MACAC;MACAC;MACAC;IACA;EACA;EAEAC;IACAC;IACAC;IACAC;EACA;EACAC;EAEAC;IACA;IACA;MACA;QACAtC;MACA;;MAEA;MACAuC;IACA;EACA;EAEAC;IACA;IACA;IACA;MACAhC;IACA;;IAEA;IACA;;IAEA;IACAiC;EACA;EAEA;EACAC;IACA;EACA;EAEAC;IACA;IACAC;MACA;QACA;UACA3B;UACAC;QACA;MACA;QACAuB;MACA;IACA;IAEA;IACAI;MAAA;MACA;MACA;QACA;UACAhD;UACAE;QACA;QACAwC;QACA;MACA;;MAEA;MACA;QACA;QACA;UACA;YACApC;YACAC;UACA;QACA;MACA;;MAEA;MACAmC;QACAO;MACA;MACA;QACAjD;MACA;MACA;MACAF;MACAA;MACAA;MACA4C;QACAQ;QACAC;QACArD;QACAsD;QACAC;UACAX;UACAA;UACA;YACA;;YAEA;YACA;cACA;cACA;YACA;;YAEA;YACA;cACA;gBACA1C;cACA;YACA;cACA;cACA;cACA;cACA;gBACA;gBACAsD;gBACA;gBACAC;gBACA;gBACAC;gBACA;gBACArC;gBACA;gBACA8B;gBACA;gBACAQ;gBACA;gBACAC;gBACA;gBACAC;gBACA;gBACAC;gBACA;gBACAC;gBACA;gBACAC;cACA;;cAEA;cACA;gBACAzD;gBACAG;gBACAI;gBACAZ;gBACAc;gBACAC;gBACAO;gBACAC;gBACAM;gBACAE;cACA;;cAEA;cACA;gBACA;gBACA;kBACA;kBAEA;oBACAL;kBACA;oBACA;oBACAA;kBACA;gBACA;gBAEA;kBACAA;gBACA;cACA;;cAEA;cACA;gBACApB;gBACAC;cACA;cACAmC;gBACAqB;gBACAjE;cACA;;cAEA;cACA;YACA;UACA;YACA;cACAE;cACAE;YACA;YACA;cACA0C;YACA;UACA;QACA;QACAoB;UACAtB;UACAA;UACA;YACA1C;YACAE;UACA;UACA0C;QACA;MACA;IACA;IAEA;IACAqB;MACA;MACA;MACA;QACA;UACAnE;QACA;MACA;;MAEA;MACA;MACA;MACA;QACAA;MACA;QACA;UACA;QACA;MACA;;MAEA;MACAA;MACA;IACA;IAEA;IACAoE;MACA;QACAzD;MACA;IACA;IAEA;IACA0D;MACA;QACAzD;MACA;IACA;IAEA;IACA0D;MACA;QACA1D;MACA;IACA;IAEA;IACA2D;MAAA;MACA;MACA;MACAvE;MACAA;MACAA;MACAA;;MAEA;MACA;MACA;QACAwE;UACAC;UACAC;UACAC;QACA;MACA;MAEA;QACA;QACA3E;;QAEA;QACA;QACA;UACA;UACA;YACA8C;YACA;UACA;UACA9C;QACA;;QAEA;QACA;UACA;YACA8C;YACA;UACA;QACA;;QAEA;QACAF;UACAO;QACA;QACA;UACAhD;QACA;QACAyC;UACAQ;UACAC;UACArD;UACAsD;UACAC;YACAX;YACA;cACA;YACA;cACAE;cACA;gBACA3C;cACA;YACA;UACA;UACA+D;YACAtB;YACA;cACAzC;YACA;YACA2C;UACA;QACA;MACA;IACA;IAEA;IACA8B;MACA;QACA;UACAC;UACA9D;QACA;QACA6B;MACA;MACAA;QACAQ;MACA;IACA;IAEA;IACA0B;MACA;QACA/D;MACA;MACA;MACA;IACA;IAEA;IACAgE;MACA;QACA;UACA/E;QACA;MACA;MACA;QACAM;MACA;IACA;IAEA;IACA0E;MACA;MACA;MACA;MACA;QACA;QACA;UACAC;QACA;MACA;MACA;QACAvD;QACAG;QACAC;MACA;IACA;IAEA;IACAoD;MACA;QACArD;MACA;IACA;IAEA;IACAsD;MACA;MACA;MACA;MACA;QACA;QACA;;QAEA;QACA;UACAF;QACA;;QAEA;QACAG;QACA;UACAzD;UACAD;UACAG;QACA;;QAEA;QACA;MACA;IACA;IAEA;IACAwD;MACA;QACA;QACA;QACA;QACA;UACAJ;QACA;QACAK;QACA;UACA5D;UACAC;UACAE;QACA;QACA;MACA;IACA;IAEA;IACA0D;MACA;MACA;MACA;QACA;UACA;UACA;QACA;MACA;QACA;MACA;;MAEA;MACA;QACA3C;UACAQ;QACA;MACA;QACAR;UACAQ;QACA;MACA;QACAN;MACA;IACA;IAEA;IACA0C;MACA;MACA;QACA;QACA;UACAhF;UACAC;UACAS;QACA;;QAEA;QACA0B;;QAEA;QACA;MACA;IACA;IAEA;IACA6C;MACA;MACA;MACA;QACA3C;QACA;MACA;;MAEA;MACA;MACA;MACAA;IACA;IAEA;IACA4C;MACA;QACA1D;MACA;MACA;IACA;IAEA;IACA2D;MACA7C;IACA;IAEA;IACA8C;MACA;MACAN;MACA;QACAA;MACA;MACA;QACA9D;MACA;IACA;IAEA;IACAqE;MACA;QACA1D;QACAC;QACAC;MACA;IACA;IAEA;IACAyD;MACA;QACA3D;MACA;IACA;IAEA;IACA4D;MACA;MACA;MACA;MACA;MACA;MACA;QACA;UACAT;QACA;QACAA;UACAU;UACAC;UACAC;QACA;MACA;QACA;UACA;UACA;YACA;UACA;QACA;MACA;MACA;QACAhE;QACAC;MACA;MACA;IACA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;AC51BA;AAAA;AAAA;AAAA;AAA24B,CAAgB,q4BAAG,EAAC,C;;;;;;;;;;;ACA/5B;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/buy/buy.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/buy/buy.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./buy.vue?vue&type=template&id=63838ed8&\"\nvar renderjs\nimport script from \"./buy.vue?vue&type=script&lang=js&\"\nexport * from \"./buy.vue?vue&type=script&lang=js&\"\nimport style0 from \"./buy.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/buy/buy.vue\"\nexport default component.exports","export * from \"-!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./buy.vue?vue&type=template&id=63838ed8&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = !(_vm.common_site_type == 1) ? _vm.goods_list.length : null\n  var l0 =\n    !(_vm.common_site_type == 1) && g0 > 0\n      ? _vm.__map(_vm.goods_list, function (group, index) {\n          var $orig = _vm.__get_orig(group)\n          var g1 =\n            (_vm.plugins_coupon_data || null) != null &&\n            (_vm.plugins_coupon_data[index] || null) != null &&\n            (_vm.plugins_coupon_data[index].coupon_data || null) != null &&\n            (_vm.plugins_coupon_data[index].coupon_data.coupon_list || null) !=\n              null &&\n            _vm.plugins_coupon_data[index].coupon_data.coupon_list.length > 0\n          var g2 = group.order_base.extension_data.length\n          return {\n            $orig: $orig,\n            g1: g1,\n            g2: g2,\n          }\n        })\n      : null\n  var g3 =\n    !(_vm.common_site_type == 1) && g0 > 0\n      ? _vm.total_price > 0 &&\n        _vm.payment_list.length > 0 &&\n        _vm.common_order_is_booking != 1\n      : null\n  var g4 = !(_vm.common_site_type == 1) ? _vm.goods_list.length : null\n  var g5 = !(_vm.common_site_type == 1) ? _vm.plugins_coupon_list.length : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        l0: l0,\n        g3: g3,\n        g4: g4,\n        g5: g5,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./buy.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./buy.vue?vue&type=script&lang=js&\"","<template>\r\n    <view>\r\n        <block v-if=\"common_site_type == 1\">\r\n            <component-no-data propStatus=\"2\" propMsg=\"展示型不允许提交订单\"></component-no-data>\r\n        </block>\r\n        <block v-else>\r\n            <view v-if=\"goods_list.length > 0\" class=\"page-bottom-fixed\">\r\n                <!-- 销售+自提 模式选择 -->\r\n                <view v-if=\"common_site_type == 4\" class=\"buy-header-nav bg-white oh tc\">\r\n                    <block v-for=\"(item, index) in buy_header_nav\" :key=\"index\">\r\n                        <view :class=\"'item fl cp ' + (site_model == item.value ? 'cr-main' : 'cr-base')\" :data-value=\"item.value\" @tap=\"buy_header_nav_event\">{{item.name}}</view>\r\n                    </block>\r\n                </view>\r\n\r\n                <view class=\"padding-horizontal-main padding-top-main\">\r\n                    <!-- 地址 -->\r\n                    <view v-if=\"common_site_type == 0 || common_site_type == 2 || common_site_type == 4\" class=\"padding-horizontal-main padding-top-main border-radius-main bg-white spacing-mb\">\r\n                        <view class=\"address arrow-right cp\" @tap=\"address_event\">\r\n                            <view v-if=\"address != null\" class=\"padding-bottom-main\">\r\n                                <view class=\"address-base\">\r\n                                    <text v-if=\"(address.alias || null) != null\" class=\"address-alias br-main cr-main round margin-right-sm text-size-xs\">{{address.alias}}</text>\r\n                                    <text>{{address.name}}</text>\r\n                                    <text class=\"fr\">{{address.tel}}</text>\r\n                                </view>\r\n                                <view class=\"address-detail oh margin-top-lg\">\r\n                                    <image class=\"icon fl\" :src=\"common_static_url+'map-icon.png'\" mode=\"widthFix\"></image>\r\n                                    <view class=\"text fr\">\r\n                                        {{address.province_name || ''}}{{address.city_name || ''}}{{address.county_name || ''}}{{address.address || ''}}\r\n                                    </view>\r\n                                </view>\r\n                            </view>\r\n                            <view v-if=\"address == null\" class=\"padding-top-xl padding-bottom-xxxl cr-gray\">\r\n                                {{(common_site_type == 0 || (common_site_type == 4 && site_model == 0)) ? '请选择收货地址' : '请选择取货地址'}}\r\n                            </view>\r\n                        </view>\r\n                        <view class=\"address-divider spacing-mb\"></view>\r\n                    </view>\r\n\r\n                    <!-- 商品数据 -->\r\n                    <view v-for=\"(group, index) in goods_list\" :key=\"index\" class=\"goods-group-list padding-main border-radius-main bg-white spacing-mb\">\r\n                        <!-- 仓库分组 -->\r\n                        <view class=\"goods-group-hd oh br-b padding-bottom-main\">\r\n                            <view class=\"fl cp\" @tap=\"warehouse_group_event\" :data-value=\"group.url || ''\">\r\n                                <image v-if=\"(group.icon || null) != null\" class=\"goods-group-icon va-m margin-right-xs\" :src=\"group.icon\" mode=\"aspectFit\"></image>\r\n                                <text class=\"goods-group-title va-m\">{{group.name}}</text>\r\n                                <text v-if=\"(group.alias || null) != null\" class=\"goods-group-alias va-m round margin-left-sm text-size-xs\">{{group.alias}}</text>\r\n                            </view>\r\n                            <!-- #ifndef MP-KUAISHOU -->\r\n                            <view v-if=\"(group.lng || 0) != 0 && (group.lat || 0) != 0\" class=\"fr\">\r\n                                <view class=\"goods-group-map-submit br round text-size-xs\" :data-index=\"index\" @tap=\"map_event\">查看地图</view>\r\n                            </view>\r\n                            <!-- #endif -->\r\n                        </view>\r\n                        <!-- 商品 -->\r\n                        <view class=\"goods-content margin-bottom-sm\">\r\n                            <view v-for=\"(item, index2) in group.goods_items\" :key=\"index2\" class=\"goods-item padding-vertical-main oh br-b-dashed\">\r\n                                <image class=\"goods-image fl radius\" :src=\"item.images\" mode=\"aspectFill\"></image>\r\n                                <view class=\"goods-base\">\r\n                                    <view class=\"goods-title multi-text\">{{item.title}}</view>\r\n                                    <view v-if=\"item.spec != null\" class=\"margin-top-xs cr-gray\">\r\n                                        <block v-for=\"(spec, si) in item.spec\" :key=\"si\">\r\n                                            <text v-if=\"si > 0\">;</text>\r\n                                            <text>{{spec.value}}</text>\r\n                                        </block>\r\n                                    </view>\r\n                                    <view class=\"oh pr margin-top-sm\">\r\n                                        <text class=\"fw-b\">{{currency_symbol}}{{item.price}}</text>\r\n                                        <text v-if=\"item.original_price > 0\" class=\"original-price margin-left-sm\">{{currency_symbol}}{{item.original_price}}</text>\r\n                                        <text class=\"buy-number pa cr-gray\">x{{item.stock}}</text>\r\n                                    </view>\r\n                                </view>\r\n                            </view>\r\n                        </view>\r\n                        <!-- 优惠劵 -->\r\n                        <view v-if=\"(plugins_coupon_data || null) != null && (plugins_coupon_data[index] || null) != null && (plugins_coupon_data[index].coupon_data || null) != null && (plugins_coupon_data[index].coupon_data.coupon_list || null) != null && plugins_coupon_data[index].coupon_data.coupon_list.length > 0\" class=\"buy-data-item buy-data-item-group arrow-right\" :data-index=\"index\" @tap=\"plugins_coupon_open_event\">\r\n                            <text class=\"cr-base\">优惠劵</text>\r\n                            <text class=\"cr-grey fr cp\">{{((plugins_choice_coupon_value || null) != null && (plugins_choice_coupon_value[group.id] || null) != null) ? plugins_choice_coupon_value[group.id] : '请选择优惠券'}}</text>\r\n                        </view>\r\n                        <!-- 门店次卡 -->\r\n                        <view v-if=\"(plugins_realstore_data || null) != null && (plugins_realstore_data[group.id] || null) != null\" class=\"plugins-realstore-container-view\">\r\n                            <block v-for=\"(item, index2) in plugins_realstore_data[group.id]['data']\" :key=\"index2\">\r\n                                <view class=\"buy-data-item buy-data-item-group arrow-right\">\r\n                                    <text class=\"cr-base va-m\">门店次卡</text>\r\n                                    <image class=\"image circle br va-m margin-left-lg\" :src=\"item.images\" mode=\"aspectFill\"></image>\r\n                                    <text class=\"cr-grey va-m margin-left-xs text-size-xs\">x{{item.stock}}</text>\r\n                                    <view class=\"right-value single-text dis-inline-block fr tr\" :data-index=\"index2\" :data-groupid=\"group.id\" @tap=\"plugins_realstore_open_event\">\r\n                                        <text class=\"cr-grey\">{{item.tips_msg}}</text>\r\n                                    </view>\r\n                                </view>\r\n                            </block>\r\n                        </view>\r\n                        <!-- 扩展数据展示 -->\r\n                        <view v-if=\"group.order_base.extension_data.length > 0\" class=\"extension-list radius margin-top-lg\">\r\n                            <view v-for=\"(item, index2) in group.order_base.extension_data\" :key=\"index2\" class=\"item oh padding-main\">\r\n                                <text class=\"cr-base fl\">{{item.name}}</text>\r\n                                <text class=\"text-tips fr\">{{item.tips}}</text>\r\n                            </view>\r\n                        </view>\r\n                        <!-- 小计 -->\r\n                        <view class=\"oh tr goods-group-footer padding-top-xl\">\r\n                            <text v-if=\"group.order_base.total_price != group.order_base.actual_price\" class=\"original-price margin-right-sm\">{{currency_symbol}}{{group.order_base.total_price}}</text>\r\n                            <text class=\"sales-price\">{{currency_symbol}}{{group.order_base.actual_price}}</text>\r\n                        </view>\r\n                    </view>\r\n\r\n                    <!-- 积分 -->\r\n                    <view v-if=\"(plugins_points_data || null) != null && (plugins_points_data.discount_price || 0) > 0\" class=\"plugins-points-buy-container padding-main border-radius-main bg-white spacing-mb\">\r\n                        <view class=\"select oh\">\r\n                            <text v-if=\"plugins_points_data.discount_type == 1\">使用{{plugins_points_data.use_integral}}个积分兑换商品</text>\r\n                            <text v-else>使用积分{{plugins_points_data.use_integral}}个</text>\r\n                            <text class=\"sales-price\">-{{currency_symbol}}{{plugins_points_data.discount_price}}</text>\r\n                            <view @tap=\"points_event\" class=\"fr cp\">\r\n                                <image class=\"icon\" :src=\"common_static_url+'select' + (plugins_points_status ? '-active' : '') + '-icon.png'\" mode=\"widthFix\"></image>\r\n                            </view>\r\n                        </view>\r\n                        <view class=\"desc\">\r\n                            <text v-if=\"plugins_points_data.discount_type == 1\">你有积分{{plugins_points_data.user_integral}}个</text>\r\n                            <text v-else>你有积分{{plugins_points_data.user_integral}}个，可用{{plugins_points_data.use_integral}}个</text>\r\n                        </view>\r\n                    </view>\r\n\r\n                    <!-- 时间选择 -->\r\n                    <view v-if=\"(buy_datetime_info || null) != null && (buy_datetime_info.is_select || false) == true\" class=\"buy-data-item bg-white border-radius-main spacing-mb arrow-right\">\r\n                        <text class=\"cr-base\">{{buy_datetime_info.title}}</text>\r\n                        <view class=\"right-value single-text dis-inline-block fr tr\">\r\n                            <component-time-select :propTitle=\"buy_datetime_info.title\" :propPlaceholder=\"buy_datetime_info.placeholder\" :propRangeDay=\"buy_datetime_info.range_day || 2\" :propRangeStartTime=\"buy_datetime_info.time_start\" :propRangeEndTime=\"buy_datetime_info.time_end\" :propDisabled=\"buy_datetime_info.disabled\" :propIsShow=\"buy_datetime_info.status\" @selectEvent=\"buy_datetime_event\">\r\n                                <text v-if=\"(buy_datetime_info.value || null) == null\" class=\"cr-grey\">{{buy_datetime_info.placeholder}}</text>\r\n                                <text v-else class=\"cr-base\">{{buy_datetime_info.value}}</text>\r\n                            </component-time-select>\r\n                        </view>\r\n                    </view>\r\n\r\n                    <!-- 留言 -->\r\n                    <view class=\"content-textarea-container padding-main border-radius-main bg-white spacing-mb\">\r\n                        <textarea v-if=\"user_note_status\" @blur=\"bind_user_note_blur_event\" @input=\"bind_user_note_event\" :focus=\"true\" :disable-default-padding=\"false\" :value=\"user_note_value\" maxlength=\"60\" placeholder=\"留言\"></textarea>\r\n                        <view v-else @tap=\"bind_user_note_tap_event\" :class=\"(user_note_value || null) == null ? 'cr-gray' : ''\">{{user_note_value || '留言'}}</view>\r\n                    </view>\r\n\r\n                    <!-- 支付方式 -->\r\n                    <view v-if=\"total_price > 0 && payment_list.length > 0 && common_order_is_booking != 1\" class=\"payment-list padding-horizontal-main padding-top-main border-radius-main bg-white oh\">\r\n                        <view v-for=\"(item, index) in payment_list\" :key=\"index\" class=\"item tc fl cp margin-bottom-main\">\r\n                            <view :class=\"'item-content radius br ' + (item.selected || '')\" :data-value=\"item.id\" @tap=\"payment_event\">\r\n                                <image v-if=\"(item.logo || null) != null\" class=\"icon margin-right-sm va-m\" :src=\"item.logo\" mode=\"widthFix\"></image>\r\n                                <text>{{item.name}}</text>\r\n                            </view>\r\n                        </view>\r\n                    </view>\r\n                </view>\r\n                \r\n                <!-- 导航 -->\r\n                <view class=\"buy-nav oh wh-auto bg-white br-t\">\r\n                    <view class=\"nav-base fl single-text padding-left-main\">\r\n                        <text>合计：</text>\r\n                        <text class=\"sales-price\">{{currency_symbol}}{{total_price}}</text>\r\n                    </view>\r\n                    <view class=\"fr nav-submit padding-top padding-bottom padding-horizontal-main\">\r\n                        <button class=\"bg-main cr-white round text-size-lg\" type=\"default\" @tap=\"buy_submit_event\" :disabled=\"buy_submit_disabled_status\" hover-class=\"none\">提交订单</button>\r\n                    </view>\r\n                </view>\r\n            </view>\r\n\r\n            <view v-if=\"goods_list.length == 0\">\r\n                <component-no-data :propStatus=\"data_list_loding_status\" :propMsg=\"data_list_loding_msg\"></component-no-data>\r\n            </view>\r\n\r\n            <!-- 优惠劵选择 -->\r\n            <component-popup :propShow=\"popup_plugins_coupon_status\" propPosition=\"bottom\" @onclose=\"plugins_coupon_close_event\">\r\n                <view class=\"plugins-coupon-popup bg-base\">\r\n                    <view class=\"close oh\">\r\n                        <view class=\"fr\" @tap.stop=\"plugins_coupon_close_event\">\r\n                            <icon type=\"clear\" size=\"20\"></icon>\r\n                        </view>\r\n                    </view>\r\n                    <view v-if=\"plugins_coupon_list.length > 0\" class=\"plugins-coupon-container padding-horizontal-main padding-bottom-main oh\">\r\n                        <view class=\"not-use-tips tc\">\r\n                            <text class=\"cp\" @tap=\"plugins_coupon_not_use_event\">不使用优惠劵</text>\r\n                        </view>\r\n                        <block v-for=\"(item, index) in plugins_coupon_list\" :key=\"index\">\r\n                            <view :class=\"'item spacing-mt bg-white border-radius-main ' + ((item.is_active || 0) == 1 ? 'item-disabled' : '')\">\r\n                                <view class=\"v-left fl\">\r\n                                    <view class=\"base single-text\" :style=\"'color:' + item.coupon.bg_color_value + ';'\">\r\n                                        <text v-if=\"item.coupon.type == 0\" class=\"symbol\">{{currency_symbol}}</text>\r\n                                        <text class=\"price\">{{item.coupon.discount_value}}</text>\r\n                                        <text class=\"unit\">{{item.coupon.type_unit}}</text>\r\n                                        <text v-if=\"(item.coupon.desc || null) != null\" class=\"desc cr-gray\">{{item.coupon.desc}}</text>\r\n                                    </view>\r\n                                    <view v-if=\"(item.coupon.use_limit_type_name || null) != null\" class=\"base-tips cr-base single-text\">{{item.coupon.use_limit_type_name}}</view>\r\n                                    <view class=\"base-time cr-gray single-text\">{{item.time_start_text}} 至 {{item.time_end_text}}</view>\r\n                                </view>\r\n                                <view :class=\"'v-right fr '+((item.is_active || 0) == 1 ? '' : 'cp')\" :style=\"'background:' + item.coupon.bg_color_value + ';'\" :data-index=\"index\" :data-value=\"item.id\" @tap=\"plugins_coupon_use_event\">\r\n                                    <text class=\"circle\"></text>\r\n                                    <text>{{(item.is_active || 0) == 1 ? '已选' : '选择'}}</text>\r\n                                </view>\r\n                            </view>\r\n                        </block>\r\n                    </view>\r\n                </view>\r\n            </component-popup>\r\n            \r\n            <!-- 次卡选择 -->\r\n            <component-popup :propShow=\"popup_plugins_realstore_status\" propPosition=\"bottom\" @onclose=\"plugins_realstore_close_event\">\r\n                <view class=\"bg-base padding-top-lg\">\r\n                    <view class=\"close oh margin-right-lg padding-bottom-sm\">\r\n                        <view class=\"fr\" @tap.stop=\"plugins_realstore_close_event\">\r\n                            <icon type=\"clear\" size=\"20\"></icon>\r\n                        </view>\r\n                    </view>\r\n                    <view class=\"plugins-realstore-container padding-horizontal-main padding-bottom-main oh\">\r\n                        <view class=\"not-use-tips tc\">\r\n                            <text class=\"cp cr-yellow text-size-sm\" data-type=\"0\" @tap=\"plugins_realstore_use_event\">不使用次卡</text>\r\n                        </view>\r\n                        <view v-if=\"(plugins_realstore_data || null) != null && (plugins_realstore_data[popup_plugins_realstore_group_id] || null) != null\">\r\n                            <block v-for=\"(item, index) in plugins_realstore_data[popup_plugins_realstore_group_id]['data'][popup_plugins_realstore_card_index]['user_card']\" :key=\"index\">\r\n                                <view :class=\"'item spacing-mt bg-white border-radius-main ' + ((item.is_active || 0) == 1 ? 'item-disabled' : '')\">\r\n                                    <view class=\"v-left fl\">\r\n                                        <view class=\"base single-text\">\r\n                                            <text class=\"value fw-b text-size-xxl\">{{item.valid_number}}</text>\r\n                                            <text class=\"unit margin-left-xs\">次</text>\r\n                                            <text v-if=\"(item.name || null) != null\" class=\"cr-base margin-left-lg\">{{item.name}}</text>\r\n                                        </view>\r\n                                        <view v-if=\"(item.describe || null) != null\" class=\"margin-top-sm cr-grey single-text\">{{item.describe}}</view>\r\n                                        <view class=\"margin-top-sm cr-gray single-text text-size-xs\">{{item.start_time}} 至 {{item.end_time}}</view>\r\n                                    </view>\r\n                                    <view v-if=\"(item.is_active || 0) == 1\" class=\"v-right bg-main fr tc cr-white\">\r\n                                        <text>已选</text>\r\n                                    </view>\r\n                                    <view v-else class=\"v-right bg-main fr tc cr-white cp\" :data-index=\"index\" :data-value=\"item.id\" data-type=\"1\" @tap=\"plugins_realstore_use_event\">\r\n                                        <text>选择</text>\r\n                                    </view>\r\n                                </view>\r\n                            </block>\r\n                        </view>\r\n                    </view>\r\n                </view>\r\n            </component-popup>\r\n        </block>\r\n    </view>\r\n</template>\r\n<script>\r\n    const app = getApp();\r\n    import componentPopup from \"../../components/popup/popup\";\r\n    import componentNoData from \"../../components/no-data/no-data\";\r\n    import componentTimeSelect from \"../../components/time-select/time-select\";\r\n\r\n    var common_static_url = app.globalData.get_static_url('common');\r\n    export default {\r\n        data() {\r\n            return {\r\n                common_static_url: common_static_url,\r\n                data_list_loding_status: 1,\r\n                buy_submit_disabled_status: false,\r\n                data_list_loding_msg: '',\r\n                params: null,\r\n                payment_list: [],\r\n                goods_list: [],\r\n                address: null,\r\n                address_id: null,\r\n                total_price: 0,\r\n                user_note_value: '',\r\n                user_note_status: false,\r\n                is_first: 1,\r\n                extension_data: [],\r\n                payment_id: 0,\r\n                common_site_type: 0,\r\n                extraction_address: [],\r\n                site_model: 0,\r\n                buy_header_nav: [\r\n                    { name: \"快递邮寄\", value: 0 },\r\n                    { name: \"自提点取货\", value: 2 }\r\n                ],\r\n                // 基础配置\r\n                currency_symbol: app.globalData.data.currency_symbol,\r\n                common_order_is_booking: 0,\r\n                // 下单时间选择\r\n                buy_datetime_info: {},\r\n                // 优惠劵\r\n                plugins_coupon_data: null,\r\n                plugins_coupon_list: [],\r\n                plugins_use_coupon_ids: [],\r\n                plugins_choice_coupon_value: [],\r\n                popup_plugins_coupon_status: false,\r\n                popup_plugins_coupon_index: null,\r\n                // 积分\r\n                plugins_points_data: null,\r\n                plugins_points_status: false,\r\n                // 门店\r\n                plugins_realstore_data: [],\r\n                plugins_choice_realstore_value: {},\r\n                popup_plugins_realstore_status: false,\r\n                popup_plugins_realstore_group_id: 0,\r\n                popup_plugins_realstore_card_index: 0\r\n            };\r\n        },\r\n\r\n        components: {\r\n            componentPopup,\r\n            componentNoData,\r\n            componentTimeSelect\r\n        },\r\n        props: {},\r\n\r\n        onLoad(params) {\r\n            //params['data'] = '{\"buy_type\":\"goods\",\"goods_id\":\"1\",\"stock\":\"1\",\"spec\":\"[]\"}';\r\n            if ((params.data || null) != null && app.globalData.get_length(JSON.parse(decodeURIComponent(params.data))) > 0) {\r\n                this.setData({\r\n                    params: JSON.parse(decodeURIComponent(params.data))\r\n                });\r\n\r\n                // 删除地址缓存\r\n                uni.removeStorageSync(app.globalData.data.cache_buy_user_address_select_key);\r\n            }\r\n        },\r\n\r\n        onShow() {\r\n            // 数据加载\r\n            this.init();\r\n            this.setData({\r\n                is_first: 0\r\n            });\r\n\r\n            // 初始化配置\r\n            this.init_config();\r\n            \r\n            // 分享菜单处理\r\n            app.globalData.page_share_handle();\r\n        },\r\n\r\n        // 下拉刷新\r\n        onPullDownRefresh() {\r\n            this.init();\r\n        },\r\n\r\n        methods: {\r\n            // 初始化配置\r\n            init_config(status) {\r\n                if ((status || false) == true) {\r\n                    this.setData({\r\n                        currency_symbol: app.globalData.get_config('currency_symbol'),\r\n                        common_order_is_booking: app.globalData.get_config('config.common_order_is_booking')\r\n                    });\r\n                } else {\r\n                    app.globalData.is_config(this, 'init_config');\r\n                }\r\n            },\r\n\r\n            // 获取数据\r\n            init() {\r\n                // 订单参数信息是否正确\r\n                if (this.params == null) {\r\n                    this.setData({\r\n                        data_list_loding_status: 2,\r\n                        data_list_loding_msg: '订单信息有误'\r\n                    });\r\n                    uni.stopPullDownRefresh();\r\n                    return false;\r\n                }\r\n\r\n                // 本地缓存地址\r\n                if (this.is_first == 0) {\r\n                    var cache_address = uni.getStorageSync(app.globalData.data.cache_buy_user_address_select_key);\r\n                    if ((cache_address || null) != null) {\r\n                        this.setData({\r\n                            address: cache_address,\r\n                            address_id: cache_address.id\r\n                        });\r\n                    }\r\n                }\r\n\r\n                // 加载loding\r\n                uni.showLoading({\r\n                    title: '加载中...'\r\n                });\r\n                this.setData({\r\n                    data_list_loding_status: 1\r\n                });\r\n                var data = this.params;\r\n                data['address_id'] = this.address_id;\r\n                data['payment_id'] = this.payment_id;\r\n                data['site_model'] = this.site_model;\r\n                uni.request({\r\n                    url: app.globalData.get_request_url(\"index\", \"buy\"),\r\n                    method: 'POST',\r\n                    data: this.request_data_ext_params_merge(data),\r\n                    dataType: 'json',\r\n                    success: res => {\r\n                        uni.stopPullDownRefresh();\r\n                        uni.hideLoading();\r\n                        if (res.data.code == 0) {\r\n                            var data = res.data.data;\r\n\r\n                            // 订单是否已提交、直接进入支付页面\r\n                            if((data.is_order_submit || 0) == 1) {\r\n                                this.buy_submit_response_handle(data);\r\n                                return false;\r\n                            }\r\n\r\n                            // 处理订单初始化数据\r\n                            if (data.goods_list.length == 0) {\r\n                                this.setData({\r\n                                    data_list_loding_status: 0\r\n                                });\r\n                            } else {\r\n                                // 下单选择时间\r\n                                var data_dt = this.buy_datetime_info || {};\r\n                                var temp_dt = data.buy_datetime_info || {};\r\n                                var datetime = {\r\n                                    // 是否开启时间选择\r\n                                    is_select: (temp_dt.is_select || 0) == 1,\r\n                                    // 是否必选\r\n                                    required: (temp_dt.required || 0) == 1,\r\n                                    // 状态\r\n                                    status: data_dt.status || (temp_dt.status || 0) == 1 || false,\r\n                                    // 默认值\r\n                                    value: data_dt.value || temp_dt.value || '',\r\n                                    // 标题\r\n                                    title: temp_dt.title || '时间',\r\n                                    // 占位文本及标题\r\n                                    placeholder: temp_dt.placeholder || '选择时间',\r\n                                    // 天起始时间\r\n                                    time_start: temp_dt.time_start || '',\r\n                                    // 天结束时间\r\n                                    time_end: temp_dt.time_end || '',\r\n                                    // 可选最大天数\r\n                                    range_day: temp_dt.range_day || 2,\r\n                                    // 禁止选择的时间\r\n                                    disabled: temp_dt.disabled || '',\r\n                                    // 未选择错误提示\r\n                                    error_msg: temp_dt.error_msg || '请选择时间'\r\n                                };\r\n\r\n                                // 设置数据\r\n                                this.setData({\r\n                                    goods_list: data.goods_list,\r\n                                    total_price: data.base.actual_price,\r\n                                    extension_data: data.extension_data || [],\r\n                                    data_list_loding_status: 3,\r\n                                    common_site_type: data.common_site_type || 0,\r\n                                    extraction_address: data.base.extraction_address || [],\r\n                                    buy_datetime_info: datetime,\r\n                                    plugins_coupon_data: data.plugins_coupon_data || null,\r\n                                    plugins_points_data: data.plugins_points_data || null,\r\n                                    plugins_realstore_data: data.plugins_realstore_data || null\r\n                                });\r\n\r\n                                // 优惠劵选择处理\r\n                                if ((data.plugins_coupon_data || null) != null) {\r\n                                    var plugins_choice_coupon_value = [];\r\n                                    for (var i in data.plugins_coupon_data) {\r\n                                        var cupk = data.plugins_coupon_data[i]['warehouse_id'];\r\n\r\n                                        if ((data.plugins_coupon_data[i]['coupon_data']['coupon_choice'] || null) != null) {\r\n                                            plugins_choice_coupon_value[cupk] = data.plugins_coupon_data[i]['coupon_data']['coupon_choice']['coupon']['desc'];\r\n                                        } else {\r\n                                            var coupon_count = (data.plugins_coupon_data[i]['coupon_data']['coupon_list'] || null) != null ? data.plugins_coupon_data[i]['coupon_data'].coupon_list.length : 0;\r\n                                            plugins_choice_coupon_value[cupk] = coupon_count > 0 ? '可选优惠劵' +coupon_count + '张' : '暂无可用优惠劵';\r\n                                        }\r\n                                    }\r\n\r\n                                    this.setData({\r\n                                        plugins_choice_coupon_value: plugins_choice_coupon_value\r\n                                    });\r\n                                }\r\n\r\n                                // 地址\r\n                                this.setData({\r\n                                    address: data.base.address || null,\r\n                                    address_id: (data.base.address || null) != null ? data.base.address.id : null\r\n                                });\r\n                                uni.setStorage({\r\n                                    key: app.globalData.data.cache_buy_user_address_select_key,\r\n                                    data: data.base.address || null\r\n                                });\r\n\r\n                                // 支付方式\r\n                                this.payment_list_data(data.payment_list);\r\n                            }\r\n                        } else {\r\n                            this.setData({\r\n                                data_list_loding_status: 2,\r\n                                data_list_loding_msg: res.data.msg\r\n                            });\r\n                            if (app.globalData.is_login_check(res.data, this, 'init')) {\r\n                                app.globalData.showToast(res.data.msg);\r\n                            }\r\n                        }\r\n                    },\r\n                    fail: () => {\r\n                        uni.stopPullDownRefresh();\r\n                        uni.hideLoading();\r\n                        this.setData({\r\n                            data_list_loding_status: 2,\r\n                            data_list_loding_msg: '服务器请求出错'\r\n                        });\r\n                        app.globalData.showToast('服务器请求出错');\r\n                    }\r\n                });\r\n            },\r\n\r\n            // 请求参数合并\r\n            request_data_ext_params_merge(data) {\r\n                // 优惠券\r\n                var coupon_ids = this.plugins_use_coupon_ids;\r\n                if ((coupon_ids || null) != null && coupon_ids.length > 0) {\r\n                    for (var i in coupon_ids) {\r\n                        data['coupon_id_' + i] = coupon_ids[i];\r\n                    }\r\n                }\r\n\r\n                // 门店次卡\r\n                var key = 'realstore_card_value';\r\n                var realstore_value = this.plugins_choice_realstore_value;\r\n                if(Object.keys(realstore_value).length > 0) {\r\n                    data[key] = realstore_value;\r\n                } else {\r\n                    if(data[key] != undefined) {\r\n                        delete data[key];\r\n                    }\r\n                }\r\n\r\n                // 积分\r\n                data['is_points'] = this.plugins_points_status === true ? 1 : 0;\r\n                return data;\r\n            },\r\n\r\n            // 用户留言输入事件\r\n            bind_user_note_event(e) {\r\n                this.setData({\r\n                    user_note_value: e.detail.value\r\n                });\r\n            },\r\n\r\n            // 用户留言点击\r\n            bind_user_note_tap_event(e) {\r\n                this.setData({\r\n                    user_note_status: true\r\n                });\r\n            },\r\n\r\n            // 用户留言失去焦点\r\n            bind_user_note_blur_event(e) {\r\n                this.setData({\r\n                    user_note_status: false\r\n                });\r\n            },\r\n\r\n            // 提交订单\r\n            buy_submit_event(e) {\r\n                // 表单数据\r\n                var data = this.params;\r\n                data['address_id'] = this.address_id;\r\n                data['payment_id'] = this.payment_id;\r\n                data['user_note'] = this.user_note_value;\r\n                data['site_model'] = this.site_model;\r\n\r\n                // 数据验证\r\n                var validation = [];\r\n                if (this.common_site_type == 0 || this.common_site_type == 2 || this.common_site_type == 4) {\r\n                    validation.push({\r\n                        fields: 'address_id',\r\n                        msg: '请选择地址',\r\n                        is_can_zero: 1\r\n                    });\r\n                }\r\n\r\n                if (app.globalData.fields_check(data, validation)) {\r\n                    // 请求参数处理\r\n                    data = this.request_data_ext_params_merge(data);\r\n\r\n                    // 是否需要选择时间\r\n                    var datetime = this.buy_datetime_info || {};\r\n                    if((datetime.is_select || false) == true) {\r\n                        // 是否必选\r\n                        if((datetime.required || false) == true && (datetime.value || null) == null) {\r\n                            app.globalData.showToast(datetime.error_msg || '请选择时间');\r\n                            return false;\r\n                        }\r\n                        data['buy_datetime_value'] = datetime.value || '';\r\n                    }\r\n\r\n                    // 是否需要选择支付方式\r\n                    if (this.total_price > 0 && this.common_order_is_booking != 1) {\r\n                        if((data.payment_id || null) == null) {\r\n                            app.globalData.showToast('请选择支付方式');\r\n                            return false;\r\n                        }\r\n                    }\r\n\r\n                    // 加载loding\r\n                    uni.showLoading({\r\n                        title: '提交中...'\r\n                    });\r\n                    this.setData({\r\n                        buy_submit_disabled_status: true\r\n                    });\r\n                    uni.request({\r\n                        url: app.globalData.get_request_url(\"add\", \"buy\"),\r\n                        method: 'POST',\r\n                        data: data,\r\n                        dataType: 'json',\r\n                        success: res => {\r\n                            uni.hideLoading();\r\n                            if (res.data.code == 0) {\r\n                                this.buy_submit_response_handle(res.data.data);\r\n                            } else {\r\n                                app.globalData.showToast(res.data.msg);\r\n                                this.setData({\r\n                                    buy_submit_disabled_status: false\r\n                                });\r\n                            }\r\n                        },\r\n                        fail: () => {\r\n                            uni.hideLoading();\r\n                            this.setData({\r\n                                buy_submit_disabled_status: false\r\n                            });\r\n                            app.globalData.showToast('服务器请求出错');\r\n                        }\r\n                    });\r\n                }\r\n            },\r\n\r\n            // 订单提交响应处理\r\n            buy_submit_response_handle(data) {\r\n                if (data.order_status == 1) {\r\n                    var pay_data = {\r\n                        order_ids: data.order_ids.join(','),\r\n                        payment_id: data.payment_id\r\n                    };\r\n                    uni.setStorageSync(app.globalData.data.cache_page_pay_key, pay_data);\r\n                }\r\n                uni.redirectTo({\r\n                    url: '/pages/user-order/user-order'\r\n                });\r\n            },\r\n\r\n            // 支付方式选择\r\n            payment_event(e) {\r\n                this.setData({\r\n                    payment_id: e.currentTarget.dataset.value\r\n                });\r\n                this.payment_list_data(this.payment_list);\r\n                this.init();\r\n            },\r\n\r\n            // 支付方式数据处理\r\n            payment_list_data(data) {\r\n                if (this.payment_id != 0) {\r\n                    for (var i in data) {\r\n                        data[i]['selected'] = (data[i]['id'] == this.payment_id) ? 'cr-main br-main' : '';\r\n                    }\r\n                }\r\n                this.setData({\r\n                    payment_list: data || []\r\n                });\r\n            },\r\n\r\n            // 优惠劵弹层开启\r\n            plugins_coupon_open_event(e) {\r\n                var index = e.currentTarget.dataset.index;\r\n                var temp_list = this.plugins_coupon_data[index]['coupon_data']['coupon_list'];\r\n                // 选中处理\r\n                if(temp_list.length > 0) {\r\n                    var temp_ids = this.plugins_use_coupon_ids;\r\n                    for(var i in temp_list) {\r\n                        temp_list[i]['is_active'] = (temp_ids.indexOf(temp_list[i]['id']) != -1) ? 1 : 0;\r\n                    }\r\n                }\r\n                this.setData({\r\n                    plugins_coupon_list: temp_list,\r\n                    popup_plugins_coupon_status: true,\r\n                    popup_plugins_coupon_index: index\r\n                });\r\n            },\r\n\r\n            // 优惠劵弹层关闭\r\n            plugins_coupon_close_event(e) {\r\n                this.setData({\r\n                    popup_plugins_coupon_status: false\r\n                });\r\n            },\r\n\r\n            // 优惠劵选择\r\n            plugins_coupon_use_event(e) {\r\n                var index = e.currentTarget.dataset.index;\r\n                var value = e.currentTarget.dataset.value;\r\n                var temp_ids = this.plugins_use_coupon_ids;\r\n                if(this.popup_plugins_coupon_index !== null && temp_ids.indexOf(value) == -1) {\r\n                    var temp_data = this.plugins_coupon_data[this.popup_plugins_coupon_index];\r\n                    var temp_list = this.plugins_coupon_list;\r\n\r\n                    // 选中处理\r\n                    for(var i in temp_list) {\r\n                        temp_list[i]['is_active'] = (index == i) ? 1 : 0;\r\n                    }\r\n                    \r\n                    // 根据仓库id和优惠券id记录\r\n                    temp_ids[temp_data['warehouse_id']] = value;\r\n                    this.setData({\r\n                        plugins_use_coupon_ids: temp_ids,\r\n                        plugins_coupon_list: temp_list,\r\n                        popup_plugins_coupon_status: false\r\n                    });\r\n\r\n                    // 重新获取数据\r\n                    this.init();\r\n                }\r\n            },\r\n\r\n            // 不使用优惠劵\r\n            plugins_coupon_not_use_event(e) {\r\n                if(this.popup_plugins_coupon_index !== null) {\r\n                    var temp_data = this.plugins_coupon_data[this.popup_plugins_coupon_index];\r\n                    var temp_list = this.plugins_coupon_list;\r\n                    var temp = this.plugins_use_coupon_ids;\r\n                    for(var i in temp_list) {\r\n                        temp_list[i]['is_active'] = 0;\r\n                    }\r\n                    temp[temp_data['warehouse_id']] = 0;\r\n                    this.setData({\r\n                        plugins_coupon_list: temp_list,\r\n                        plugins_use_coupon_ids: temp,\r\n                        popup_plugins_coupon_status: false\r\n                    });\r\n                    this.init();\r\n                }\r\n            },\r\n\r\n            // 地址选择事件\r\n            address_event(e) {\r\n                // 带上参数\r\n                var json = this.params || null;\r\n                if(json != null) {\r\n                    var params = '&'+Object.keys(json).map(function(key) {\r\n                            var temp_val = (json[key] === undefined || json[key] === null) ? '' : json[key];\r\n                            return encodeURIComponent(key) + '=' + encodeURIComponent(temp_val);\r\n                        }).join('&');\r\n                } else {\r\n                    var params = '';\r\n                }\r\n\r\n                // 仅自提和快递需要选择地址\r\n                if (this.common_site_type == 0 || this.common_site_type == 4 && this.site_model == 0) {\r\n                    uni.navigateTo({\r\n                        url: '/pages/user-address/user-address?is_back=1'+params\r\n                    });\r\n                } else if (this.common_site_type == 2 || this.common_site_type == 4 && this.site_model == 2) {\r\n                    uni.navigateTo({\r\n                        url: '/pages/extraction-address/extraction-address?is_back=1&is_buy=1'+params\r\n                    });\r\n                } else {\r\n                    app.globalData.showToast('当前模式不允许使用地址');\r\n                }\r\n            },\r\n\r\n            // 销售+自提 模式选择事件\r\n            buy_header_nav_event(e) {\r\n                var value = e.currentTarget.dataset.value || 0;\r\n                if (value != this.site_model) {\r\n                    // 数据设置\r\n                    this.setData({\r\n                        address: null,\r\n                        address_id: null,\r\n                        site_model: value\r\n                    });\r\n\r\n                    // 删除地址缓存\r\n                    uni.removeStorageSync(app.globalData.data.cache_buy_user_address_select_key);\r\n                    \r\n                    // 数据初始化\r\n                    this.init();\r\n                }\r\n            },\r\n\r\n            // 地图查看\r\n            map_event(e) {\r\n                var index = e.currentTarget.dataset.index || 0;\r\n                var data = this.goods_list[index] || null;\r\n                if (data == null) {\r\n                    app.globalData.showToast(\"地址有误\");\r\n                    return false;\r\n                }\r\n\r\n                // 打开地图\r\n                var name = data.alias || data.name || '';\r\n                var address = (data.province_name || '') + (data.city_name || '') + (data.county_name || '') + (data.address || '');\r\n                app.globalData.open_location(data.lng, data.lat, name, address);\r\n            },\r\n\r\n            // 积分选择事件\r\n            points_event(e) {\r\n                this.setData({\r\n                    plugins_points_status: !this.plugins_points_status\r\n                });\r\n                this.init();\r\n            },\r\n\r\n            // 仓库事件\r\n            warehouse_group_event(e) {\r\n                app.globalData.url_event(e);\r\n            },\r\n\r\n            // 下单选择时间\r\n            buy_datetime_event(e) {\n                var temp = this.buy_datetime_info;\n                temp['status'] = !temp.status;\n                if(e != 'open' && e != 'close') {\n                    temp['value'] = (((e || null) != null) ? e._date : '') || '';\n                }\n                this.setData({\n                    buy_datetime_info: temp\n                });\r\n            },\r\n\r\n            // 打开次卡选择\r\n            plugins_realstore_open_event(e) {\r\n                this.setData({\r\n                    popup_plugins_realstore_status: true,\r\n                    popup_plugins_realstore_group_id: e.currentTarget.dataset.groupid || 0,\r\n                    popup_plugins_realstore_card_index: e.currentTarget.dataset.index || 0,\r\n                });\r\n            },\r\n\r\n            // 关闭次卡选择\r\n            plugins_realstore_close_event(e) {\r\n                this.setData({\r\n                    popup_plugins_realstore_status: false\r\n                });\r\n            },\r\n\r\n            // 次卡选择事件\r\n            plugins_realstore_use_event(e) {\r\n                var type = e.currentTarget.dataset.type;\r\n                var group_id = this.popup_plugins_realstore_group_id;\r\n                var card_index = this.popup_plugins_realstore_card_index;\r\n                var id = this.plugins_realstore_data[group_id]['data'][card_index]['id'];\r\n                var temp = this.plugins_choice_realstore_value;\r\n                if(type == 1) {\r\n                    if(temp[group_id] == undefined) {\r\n                        temp[group_id] = {};\r\n                    }\r\n                    temp[group_id][id] = {\r\n                        group_id: group_id,\r\n                        data_id: id,\r\n                        card_id: e.currentTarget.dataset.value\r\n                    };\r\n                } else {\r\n                    if(temp[group_id] != undefined && temp[group_id][id] != undefined) {\r\n                        delete temp[group_id][id];\r\n                        if(Object.keys(temp[group_id]).length <= 0) {\r\n                            delete temp[group_id];\r\n                        }\r\n                    }\r\n                }\r\n                this.setData({\r\n                    plugins_choice_realstore_value: temp,\r\n                    popup_plugins_realstore_status: false\r\n                });\r\n                this.init();\r\n            }\r\n        }\r\n    };\r\n</script>\r\n<style>\r\n    @import './buy.css';\r\n</style>","import mod from \"-!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./buy.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--6-oneOf-1-0!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--6-oneOf-1-1!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--6-oneOf-1-2!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--6-oneOf-1-3!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!D:\\\\HB\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./buy.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1678688329041\n      var cssReload = require(\"D:/HB/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}